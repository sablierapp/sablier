apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: sablier
  namespace: istio-system
spec:
  selector:
    matchLabels:
      istio: ingressgateway
  url: file:///opt/filters/sablierproxywasm.wasm/..data/sablierproxywasm.wasm
  # Use https://istio.io/latest/docs/reference/config/proxy_extensions/wasm-plugin/#WasmPlugin-TrafficSelector
  # To specify which service to apply this filter only
  phase: UNSPECIFIED_PHASE
  pluginConfig:
    {
      "sablier_url": "sablier.kube-system.svc.cluster.local",
      "cluster": "outbound|10000||sablier.kube-system.svc.cluster.local",
      "group": "demo",
      "session_duration": "30s",
      "dynamic": {
        "display_dame": "From wasm",
        "show_details": true,
        "theme": "hacker-terminal",
        "refresh_frequency": "5s"
      }
    }