# nginx.conf
events {}

# nginx master process gets a default 'main' VM
# a new top-level configuration block receives all configuration for this main VM
wasm {
    module proxywasm_sablier_plugin /wasm/sablierproxywasm.wasm;
}

error_log /dev/stdout info;

# each nginx worker process is able to instantiate wasm modules in its subsystems
http {
    access_log /dev/stdout;
    server {
        listen 9000;

        location / {
            resolver     127.0.0.11 ipv6=off;
            proxy_wasm  proxywasm_sablier_plugin '{ "sablier_url": "sablier:10000", "group": "demo", "session_duration": "10s", "dynamic": { "display_dame": "From wasm", "show_details": true, "theme": "hacker-terminal", "refresh_frequency": "5s" } }';

            proxy_pass  http://web_service:80;
        }
    }
}